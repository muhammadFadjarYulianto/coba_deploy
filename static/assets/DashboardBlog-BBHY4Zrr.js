import{az as D,Q as T,ac as W,r as d,a2 as me,j as e,$ as xe,a0 as he,T as j,M as N,B as p,a7 as P,a8 as A,a9 as E,aa as F,ad as H,ae as J,a3 as ge,a4 as U,a5 as K,a6 as R}from"./index-CS89oW_i.js";import{C as pe,b as ue}from"./card-BhL9r1mA.js";import{T as je,a as be,b as y,c as k,d as fe,e as g}from"./table-DDg6W2BM.js";import{B as Ne,a as ke,b as O,c as V,d as Q,e as ve}from"./breadcrumb-C9uIPhjY.js";import{L as b}from"./label-Dc6lHONL.js";import{T as Y}from"./textarea-BkPyec1X.js";import{P as ye,c as we,d as I,a as Be,b as Se,e as De}from"./pagination-CKnmYpEc.js";import{S as Te}from"./search-Dnv9-eiG.js";import{P as Me,a as Ce}from"./plus-D3vUtzE_.js";import{T as _e}from"./trash-2-Cy-5REkh.js";const Pe=async r=>{try{let s=D;if(Object.keys(r).length>0){const u=new URLSearchParams;if(r.keyword&&u.append("keyword",r.keyword),r.page){const f=(r.page-1)*(r.limit||5);u.append("start",f+1)}r.limit&&u.append("limit",r.limit),s+=`?${u.toString()}`}const i=(await T.get(s,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).data.data;return{blogs:i.pagination.results,pagination:{next:i.pagination.next,previous:i.pagination.previous,per_page:i.pagination.per_page,start_index:i.pagination.start_index,total_data:i.pagination.total_data}}}catch(s){throw s}};async function Ae(r){try{const s=await W(),n=new FormData;n.append("created_by",s.id.toString());for(const[u,f]of r.entries())n.append(u,f);return(await T.post(D,n,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).data.data}catch(s){throw console.error("Create Blog Error:",s),new Error("Gagal membuat blog. Silakan coba lagi.")}}async function Ee(r,s){try{const n=await W();return s.append("created_by",n.id.toString()),(await T.put(`${D}/${r}`,s,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).data.data}catch(n){throw console.error("Gagal memperbarui blog:",n.response||n.message),new Error("Gagal memperbarui blog. Silakan coba lagi.")}}async function Fe(r){try{const s=localStorage.getItem("access_token");return(await T.delete(`${D}/${r}`,{headers:{Authorization:`Bearer ${s}`}})).data.data}catch(s){throw console.error("Gagal menghapus blog:",s.response||s.message),new Error("Gagal menghapus blog. Silakan coba lagi.")}}function Re(){const[r,s]=d.useState([]),[n,i]=d.useState(!1),[u,f]=d.useState(!1),[X,w]=d.useState(!1),[Oe,Z]=d.useState(1),[B,ee]=d.useState(1),[l,G]=d.useState(null),[ae,$]=d.useState(!0),[te,L]=d.useState(null),[m,q]=d.useState({keyword:"",page:1,limit:5}),[z,se]=d.useState(0),{toast:v}=me(),S=async()=>{try{$(!0);const a=Object.fromEntries(Object.entries(m).filter(([x,h])=>h!==""&&h!==null)),{blogs:t,pagination:o}=await Pe(a);s(t),se(o.total_data),ee(Math.ceil(o.total_data/m.limit)),Z(m.page),L(null)}catch(a){const t=a instanceof Error?a.message:"Gagal mengambil blog";L(t)}finally{$(!1)}},M=a=>{if(console.log("Changing to page:",a),a<1||a>B){console.log("Invalid page number");return}q(t=>(console.log("Updating filters from:",t,"to page:",a),{...t,page:a}))};d.useEffect(()=>{S()},[m]);const re=(a,t)=>{q(o=>{const x={...o,[a]:t||"",page:1};return Object.keys(x).forEach(h=>{(x[h]===""||x[h]===null)&&delete x[h]}),x})},le=async a=>{a.preventDefault();const t=new FormData(a.currentTarget);try{await Ae(t),S(),i(!1),v({title:"Blog Berhasil Ditambahkan",description:"Blog baru telah berhasil ditambahkan."})}catch{v({title:"Gagal Menambahkan Blog",description:"Terjadi kesalahan saat menambahkan Blog.",variant:"destructive"})}},ne=async a=>{if(a.preventDefault(),!l)return;const t=new FormData(a.currentTarget);try{await Ee(l.id,t),S(),f(!1),v({title:"Produk Berhasil Diperbarui",description:"Produk telah berhasil diperbarui."})}catch{v({title:"Gagal Memperbarui Produk",description:"Terjadi kesalahan saat memperbarui produk.",variant:"destructive"})}},ie=async a=>{try{await Fe(a),w(!1);const t=z-1,o=Math.ceil(t/m.limit);S(),v({title:"Blog Berhasil Dihapus",description:"Blog telah berhasil dihapus."})}catch{v({title:"Gagal Menghapus Blog",description:"Terjadi kesalahan saat menghapus Blog.",variant:"destructive"})}},oe=a=>{const t=new Date(a),o=["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],x=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],h=o[t.getDay()],C=t.getDate(),_=x[t.getMonth()],c=t.getFullYear();return`${h}, ${C} ${_} ${c}`},ce=a=>{G(a),f(!0)},de=({blogs:a,loading:t,error:o,formatDate:x,openEditModal:h,setCurrentBlog:C,setIsDeleteModalOpen:_})=>t?e.jsx(y,{children:e.jsx(g,{colSpan:7,className:"text-center py-4",children:e.jsx(j,{variant:"p-regular",children:"Loading..."})})}):o?e.jsx(y,{children:e.jsx(g,{colSpan:7,className:"text-center py-4 text-red-500",children:e.jsx(j,{variant:"p-regular",children:o})})}):a.length===0?e.jsx(y,{children:e.jsx(g,{colSpan:7,className:"text-center py-4 text-slate-700",children:e.jsx(j,{variant:"p-semibold",children:"Tidak ada blog"})})}):e.jsx(e.Fragment,{children:a.map(c=>e.jsxs(y,{children:[e.jsx(g,{children:e.jsx("img",{src:c.img_file,alt:c.title,className:"w-24 h-24 object-cover rounded-lg"})}),e.jsx(g,{children:c.author}),e.jsx(g,{className:"max-w-20",children:c.title}),e.jsx(g,{className:"text-center",children:c.views.toLocaleString("id-ID")}),e.jsx(g,{className:"text-center",children:c.approved_comments_count.toLocaleString("id-ID")})," ",e.jsx(g,{className:"text-center",children:x(c.created_at)}),e.jsx(g,{children:e.jsx(ge,{children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(U,{children:[e.jsx(K,{asChild:!0,children:e.jsx(p,{variant:"outline",size:"icon",onClick:()=>h(c),children:e.jsx(Ce,{className:"w-4 h-4"})})}),e.jsx(R,{className:"bg-emerald-600",children:e.jsx("p",{className:"text-background",children:"Edit Blog"})})]}),e.jsxs(U,{children:[e.jsx(K,{asChild:!0,children:e.jsx(p,{variant:"outline",size:"icon",className:"text-red-500 hover:text-red-600",onClick:()=>{C(c),_(!0)},children:e.jsx(_e,{className:"w-4 h-4"})})}),e.jsx(R,{className:"bg-emerald-600",children:e.jsx("p",{className:"text-background",children:"Hapus Blog"})})]})]})})})]},c.id))});return e.jsxs(e.Fragment,{children:[e.jsx("header",{className:"flex h-16 shrink-0 items-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-2 px-4",children:[e.jsx(xe,{className:"-ml-1"}),e.jsx(he,{orientation:"vertical",className:"mr-2 h-4"}),e.jsx(Ne,{children:e.jsxs(ke,{children:[e.jsx(O,{className:"hidden md:block",children:e.jsx(V,{href:"/",className:"text-[16px] font-normal leading-[28px]",children:"Beranda"})}),e.jsx(Q,{className:"hidden md:block"}),e.jsx(O,{children:e.jsx(V,{href:"/Dashboard",className:"text-[16px] font-normal leading-[28px]",children:"Dashboard"})}),e.jsx(Q,{className:"hidden md:block"}),e.jsx(O,{children:e.jsx(ve,{className:"text-[16px] font-normal leading-[28px]",children:"Blog"})})]})})]})}),e.jsxs("div",{className:"flex flex-1 flex-col gap-4 p-4 pt-0 pb-0",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 mr-0 md:mr-6",children:[e.jsxs("div",{children:[e.jsx(j,{variant:"h1",className:"text-4xl lg:text-5xl",children:"Manajemen Blog"}),e.jsx(j,{variant:"p-regular",className:"text-slate-700 mt-4",children:"Manajemen Blog memungkinkan Anda untuk mengelola blog yang akan ditampilkan di halaman blog."})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row w-full lg:w-auto gap-4 items-stretch sm:items-center",children:[e.jsxs("div",{className:"relative w-full sm:w-[300px]",children:[e.jsx(Te,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx(N,{placeholder:"Cari produk berdasarkan nama",value:m.keyword,onChange:a=>re("keyword",a.target.value),className:"h-11 pl-10 text-emerald-600 border-2 border-emerald-500 w-full focus:ring-emerald-500 focus:border-emerald-500"})]}),e.jsxs(p,{variant:"primary",className:"h-11 px-4 text-white shadow-lg flex items-center gap-2 bg-emerald-500 hover:bg-emerald-600 transition-colors whitespace-nowrap",onClick:()=>i(!0),children:[e.jsx(Me,{className:"w-5 h-5"}),"Tambah Produk"]})]})]}),e.jsx("div",{className:"grid gap-4 grid-cols-1",children:e.jsx(pe,{children:e.jsx(ue,{className:"p-0 md:p-6",children:e.jsxs(je,{children:[e.jsx(be,{children:e.jsxs(y,{children:[e.jsx(k,{className:"text-xl",children:"Gambar"}),e.jsx(k,{className:"text-xl",children:"Author"}),e.jsx(k,{className:"text-xl",children:"Nama Blog"}),e.jsx(k,{className:"text-xl text-center",children:"Di Baca"}),e.jsx(k,{className:"text-xl text-center",children:"Komentar"}),e.jsx(k,{className:"text-xl text-center",children:"Tanggal Dibuat"}),e.jsx(k,{className:"text-xl text-right",children:"Aksi"})]})}),e.jsx(fe,{children:e.jsx(de,{blogs:r,loading:ae,error:te,formatDate:oe,openEditModal:ce,setCurrentBlog:G,setIsDeleteModalOpen:w})})]})})})}),z>B&&e.jsx("div",{className:"mb-8",children:e.jsx(ye,{children:e.jsxs(we,{children:[e.jsx(I,{children:e.jsx(Be,{onClick:()=>M(m.page-1),className:m.page<=1?"pointer-events-none opacity-50":"cursor-pointer"})}),Array.from({length:B},(a,t)=>t+1).map(a=>e.jsx(I,{children:e.jsx(Se,{className:"cursor-pointer",onClick:()=>M(a),isActive:m.page===a,children:a})},a)),e.jsx(I,{children:e.jsx(De,{onClick:()=>M(m.page+1),className:m.page>=B?"pointer-events-none opacity-50":"cursor-pointer"})})]})})})]}),e.jsx(P,{open:n,onOpenChange:i,children:e.jsxs(A,{className:"max-w-2xl",children:[e.jsxs(E,{children:[e.jsx(F,{className:"text-center text-[30px] font-bold leading-[36px]",children:"Tambah Blog Baru"}),e.jsx(j,{variant:"p-regular",className:"text-left text-slate-500",children:"Tambahkan blog baru ke dalam daftar blog yang tersedia. blog akan langsung tampil di halaman blog. blog yang ditambahkan dapat diubah atau dihapus kembali."})]}),e.jsx("form",{onSubmit:le,children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx("div",{className:"items-center justify-center rounded-lg gap-4",children:e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(b,{htmlFor:"title",className:"text-[16px] font-bold text-emerald-600",children:"Judul"}),e.jsx(N,{id:"title",name:"title",className:"col-span-3 h-10 text-slate-900 border border-slate-50 focus:border-slate-100",placeholder:"Masukkan judul blog",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(b,{htmlFor:"author",className:"text-[16px] font-bold text-emerald-600",children:"Author"}),e.jsx(N,{id:"author",name:"author",className:"col-span-3 h-10 text-slate-900 border border-slate-50 focus:border-slate-100",placeholder:"Masukkan nama author",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(b,{htmlFor:"img_file",className:"text-[16px] font-bold text-emerald-600",children:"Gambar"}),e.jsx(N,{id:"img_file",name:"img_file",type:"text",className:"col-span-3 h-10 text-slate-900 border border-slate-50 focus:border-slate-100",placeholder:"Url",required:!0})]})]})}),e.jsxs("div",{className:"lg:col-span-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(b,{htmlFor:"content",className:"text-[16px] font-bold text-emerald-600",children:"Konten Blog"}),e.jsx(Y,{id:"content",name:"content",className:"col-span-3 min-h-[90px] text-justify text-slate-900 border border-slate-50 focus:border-slate-100",placeholder:"Masukkan konten blog",rows:10,required:!0})]}),e.jsxs(H,{className:"mt-4",children:[e.jsx(J,{asChild:!0,children:e.jsx(p,{type:"button",variant:"destructive",children:"Batal"})}),e.jsx(p,{type:"submit",className:"mb-3 md:mb-0",children:"Simpan"})]})]})]})})]})}),e.jsx(P,{open:u,onOpenChange:f,children:e.jsxs(A,{className:"max-w-2xl",children:[e.jsxs(E,{children:[e.jsx(F,{className:"text-center text-[30px] font-bold leading-[36px]",children:"Edit Blog"}),e.jsx(j,{variant:"p-regular",className:"text-left text-slate-500",children:"Ubah detail blog yang ada di daftar blog yang tersedia."})]}),e.jsx("form",{onSubmit:ne,children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx("div",{className:"items-center justify-center rounded-lg gap-4",children:e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(b,{htmlFor:"title",className:"text-[16px] font-bold text-emerald-600",children:"Judul"}),e.jsx(N,{id:"title",name:"title",defaultValue:l==null?void 0:l.title,className:"col-span-3 h-10 text-slate-900 border border-slate-50 focus:border-slate-100",placeholder:"Masukkan judul blog",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(b,{htmlFor:"author",className:"text-[16px] font-bold text-emerald-600",children:"Author"}),e.jsx(N,{id:"author",name:"author",defaultValue:l==null?void 0:l.author,className:"col-span-3 h-10 text-slate-900 border border-slate-50 focus:border-slate-100",placeholder:"Masukkan nama author",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(b,{htmlFor:"img_file",className:"text-[16px] font-bold text-emerald-600",children:"Gambar"}),e.jsx(N,{id:"img_file",name:"img_file",type:"text",defaultValue:l==null?void 0:l.img_file,className:"col-span-3 h-10 text-slate-900 border border-slate-50 focus:border-slate-100",placeholder:"Url",required:!0})]})]})}),e.jsxs("div",{className:"lg:col-span-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(b,{htmlFor:"content",className:"text-[16px] font-bold text-emerald-600",children:"Konten Blog"}),e.jsx(Y,{id:"content",name:"content",defaultValue:l==null?void 0:l.content,className:"col-span-3 min-h-[90px] text-justify text-slate-900 border border-slate-50 focus:border-slate-100",placeholder:"Masukkan konten blog",rows:10,required:!0})]}),e.jsxs(H,{className:"mt-4",children:[e.jsx(J,{asChild:!0,children:e.jsx(p,{type:"button",variant:"destructive",children:"Batal"})}),e.jsx(p,{type:"submit",className:"mb-3 md:mb-0",children:"Simpan"})]})]})]})})]})}),e.jsx(P,{open:X,onOpenChange:w,children:e.jsxs(A,{children:[e.jsxs(E,{className:"space-y-4",children:[e.jsx(F,{className:"text-left text-[30px] font-bold leading-[36px]",children:"Hapus Blog"}),e.jsx(j,{variant:"p-regular",className:"text-left max-w-lg text-slate-500",children:"Apakah Anda yakin ingin menghapus blog ini? Blog yang dihapus tidak dapat dikembalikan."})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(p,{variant:"secondary",onClick:()=>w(!1),children:"Batal"}),e.jsx(p,{variant:"destructive",onClick:()=>{ie(l.id)},children:"Hapus"})]})]})})]})}export{Re as default};
