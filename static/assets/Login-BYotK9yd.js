import{c as q,i as K,r as m,x as V,m as G,j as e,P as T,p as R,q as X,U as J,V as U,s as L,X as Q,Q as w,Y as M,Z as Y,R as x,J as Z,B as P,_ as W,T as C,M as _}from"./index-CS89oW_i.js";import{C as ee,b as te}from"./card-BhL9r1mA.js";import{L as A}from"./label-Dc6lHONL.js";import{A as ae}from"./arrow-left-CadYh-ps.js";import{E as se}from"./eye-DjVyHYfL.js";/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=q("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var S="Checkbox",[oe,xe]=K(S),[ne,ce]=oe(S),B=m.forwardRef((t,a)=>{const{__scopeCheckbox:s,name:r,checked:o,defaultChecked:n,required:u,disabled:c,value:p="on",onCheckedChange:g,form:h,...y}=t,[l,k]=m.useState(null),i=V(a,d=>k(d)),v=m.useRef(!1),I=l?h||!!l.closest("form"):!0,[b=!1,E]=G({prop:o,defaultProp:n,onChange:g}),$=m.useRef(b);return m.useEffect(()=>{const d=l==null?void 0:l.form;if(d){const j=()=>E($.current);return d.addEventListener("reset",j),()=>d.removeEventListener("reset",j)}},[l,E]),e.jsxs(ne,{scope:s,state:b,disabled:c,children:[e.jsx(T.button,{type:"button",role:"checkbox","aria-checked":f(b)?"mixed":b,"aria-required":u,"data-state":z(b),"data-disabled":c?"":void 0,disabled:c,value:p,...y,ref:i,onKeyDown:R(t.onKeyDown,d=>{d.key==="Enter"&&d.preventDefault()}),onClick:R(t.onClick,d=>{E(j=>f(j)?!0:!j),I&&(v.current=d.isPropagationStopped(),v.current||d.stopPropagation())})}),I&&e.jsx(le,{control:l,bubbles:!v.current,name:r,value:p,checked:b,required:u,disabled:c,form:h,style:{transform:"translateX(-100%)"},defaultChecked:f(n)?!1:n})]})});B.displayName=S;var D="CheckboxIndicator",O=m.forwardRef((t,a)=>{const{__scopeCheckbox:s,forceMount:r,...o}=t,n=ce(D,s);return e.jsx(X,{present:r||f(n.state)||n.state===!0,children:e.jsx(T.span,{"data-state":z(n.state),"data-disabled":n.disabled?"":void 0,...o,ref:a,style:{pointerEvents:"none",...t.style}})})});O.displayName=D;var le=t=>{const{control:a,checked:s,bubbles:r=!0,defaultChecked:o,...n}=t,u=m.useRef(null),c=J(s),p=U(a);m.useEffect(()=>{const h=u.current,y=window.HTMLInputElement.prototype,k=Object.getOwnPropertyDescriptor(y,"checked").set;if(c!==s&&k){const i=new Event("click",{bubbles:r});h.indeterminate=f(s),k.call(h,f(s)?!1:s),h.dispatchEvent(i)}},[c,s,r]);const g=m.useRef(f(s)?!1:s);return e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:o??g.current,...n,tabIndex:-1,ref:u,style:{...t.style,...p,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function f(t){return t==="indeterminate"}function z(t){return f(t)?"indeterminate":t?"checked":"unchecked"}var F=B,ie=O;const H=m.forwardRef(({className:t,checked:a,onCheckedChange:s,...r},o)=>e.jsx(F,{ref:o,checked:a,onCheckedChange:s,className:L("peer h-8 w-8 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...r,children:e.jsx(ie,{className:L("flex items-center justify-center text-current"),children:e.jsx(Q,{className:"h-8 w-8 text-white"})})}));H.displayName=F.displayName;const de=""+new URL("img-login-DI7t_hKD.svg",import.meta.url).href;class N{static async login(a,s,r){try{this.validateLoginInputs(a,s,r);const o=!!r,n=await w.post(Y,{email:a,password:s,remember_me:o},{headers:{"Content-Type":"application/json"},timeout:8e3}),{access_token:u,refresh_token:c}=n.data.data;return localStorage.setItem("access_token",u),localStorage.setItem("refresh_token",c),n.data}catch(o){throw console.error("Login gagal:",o.response||o.message),new Error("Login gagal. Periksa kembali kredensial Anda.")}}static logout(){localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("admin_data")}static async refreshAccessToken(){const a=localStorage.getItem("refresh_token");if(!a)throw new Error("Refresh token tidak tersedia. Silakan login kembali.");try{const s=await w.post(M,{},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`}}),{access_token:r,refresh_token:o}=s.data.data;return localStorage.setItem("access_token",r),localStorage.setItem("refresh_token",o),w.defaults.headers.common.Authorization=`Bearer ${r}`,r}catch{throw this.logout(),window.location.href="/login",new Error("Sesi Anda telah berakhir. Silakan login kembali.")}}static validateLoginInputs(a,s,r){if(!a||!s)throw new Error("Email dan password harus diisi.");if(typeof r!="boolean")throw new Error("Remember me harus berupa boolean.");if(!this.isValidEmail(a))throw new Error("Format email tidak valid.")}static isValidEmail(a){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)}static getAccessToken(){return localStorage.getItem("access_token")}static isAccessTokenValid(){const a=this.getAccessToken();if(!a)return!1;try{const r=JSON.parse(atob(a.split(".")[1])).exp*1e3;return Date.now()/1e3+10<r}catch{return!1}}}w.interceptors.request.use(t=>{const a=N.getAccessToken();return a&&N.isAccessTokenValid()&&(t.headers.Authorization=`Bearer ${a}`),t},t=>Promise.reject(t));w.interceptors.response.use(t=>t,async t=>{var s;const a=t.config;if(((s=t.response)==null?void 0:s.status)===401&&!a._retry&&a.url!==M){a._retry=!0;try{const r=await N.refreshAccessToken();return a.headers.Authorization=`Bearer ${r}`,w(a)}catch(r){return N.logout(),window.location.href="/login",Promise.reject(r)}}return Promise.reject(t)});function ge(){const[t,a]=x.useState(""),[s,r]=x.useState(""),[o,n]=x.useState(!1),[u,c]=x.useState(""),[p,g]=x.useState(!1),[h,y]=x.useState(!1),l=Z(),k=async i=>{i.preventDefault(),c(""),g(!0);try{await N.login(t,s,h),l("/dashboard")}catch(v){c("Login gagal. Periksa email dan password Anda."),console.error("Login Error:",v)}finally{g(!1)}};return x.useEffect(()=>{document.getElementById("email").focus()},[]),m.useEffect(()=>{localStorage.getItem("access_token")&&l("/dashboard")},[]),e.jsx("div",{className:"w-full h-screen",children:e.jsxs("div",{className:"flex items-stretch w-full h-full",children:[e.jsx("div",{className:"hidden relative lg:flex lg:w-10/12 p-12",children:e.jsx("img",{src:de,alt:"GreenLify Logo",className:"absolute inset-0 w-full h-full object-cover",loading:"lazy"})}),e.jsx("div",{className:"flex items-center justify-center w-full lg:w-1/2 p-6",children:e.jsxs(ee,{className:"w-full max-w-xl",children:[e.jsx("div",{className:"w-full flex gap-3 items-center mb-[66px]",children:e.jsx(P,{variant:"icon",className:"bg-emerald-500 hover:bg-emerald-600 shadow-lg",onClick:()=>l("/"),children:e.jsx(ae,{className:"h-4 w-4 text-background"})})}),e.jsxs(te,{className:"space-y-8 p-8",children:[e.jsxs("div",{className:"space-y-8",children:[e.jsx("img",{src:W,alt:"GreenLify Logo",className:"w-34 mx-auto"}),e.jsx(C,{variant:"h1",className:" text-center text-emerald-600",children:"Admin Login"}),e.jsx(C,{variant:"p",className:"text-center",children:"pengelolaan sampah dengan deteksi menggunakan teknologi AI dan promosi produk ramah lingkungan"})]}),e.jsxs("form",{onSubmit:k,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(A,{htmlFor:"email",className:"text-[18px] font-bold text-emerald-600",children:"Email"}),e.jsx(_,{id:"email",type:"email",placeholder:"admin@gmail.com",className:"h-12 text-slate-900 border border-slate-50 focus:border-slate-100",value:t,onChange:i=>a(i.target.value)})]}),e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsx(A,{htmlFor:"password",className:"text-[18px] font-bold text-emerald-600",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(_,{id:"password",type:o?"text":"password",placeholder:"Enter your password",className:"h-12 text-slate-900 border border-slate-50 focus:border-slate-100",value:s,onChange:i=>r(i.target.value)}),e.jsx("button",{type:"button",onClick:()=>n(!o),"aria-label":o?"Hide password":"Show password",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-sm leading-5",children:o?e.jsx(re,{className:"text-emerald-500"}):e.jsx(se,{className:"text-emerald-500"})})]})]}),u&&e.jsx(C,{variant:"small",className:"text-center text-red-500 mt-2",children:u}),e.jsxs("div",{className:"flex items-center space-x-4 my-4",children:[e.jsx(H,{id:"remember",className:"bg-emerald-500",checked:h,onCheckedChange:i=>y(!!i)}),e.jsx(C,{variant:"small",className:"text-gray-500",children:e.jsx("label",{htmlFor:"remember",className:"text-[14px] font-bold",children:"Biarkan saya tetap masuk"})})]}),e.jsx(P,{type:"submit",className:"w-full bg-emerald-500 hover:bg-emerald-600",disabled:p||!t||!s,children:p?e.jsxs(e.Fragment,{children:["Memuat...",e.jsx("span",{className:"loader inline-block ml-2"})]}):"Masuk"})]}),e.jsxs(C,{variant:"p",className:"text-center",children:["Kesulitan, Perlu bantuan?"," ",e.jsx("a",{href:"/tentangkami",className:"text-emerald-600 hover:underline",children:"Hubungi kami"})]})]})]})})]})})}export{ge as default};
